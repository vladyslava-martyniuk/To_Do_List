{% extends "base.html" %}

{% block title %}–ú–æ—ó –∑–∞–≤–¥–∞–Ω–Ω—è{% endblock %}

{% block content %}
<div class="bg-white p-6 rounded-xl shadow-lg">

    <!-- –í–µ—Ä—Ö–Ω—è –ø–∞–Ω–µ–ª—å –∑ –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è–º —ñ –≤–∏—Ö–æ–¥–æ–º -->
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-gray-800">–ü—Ä–∏–≤—ñ—Ç, {{ username }} üëã</h1>
        <a href="{{ url_for('logout') }}" 
           class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition">
            –í–∏–π—Ç–∏
        </a>
    </div>

    <!-- –ü–æ—à—É–∫ —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∏ -->
    <form method="get" action="{{ url_for('tasks_page') }}" class="flex gap-2 mb-6">
        <input type="text" name="q" value="{{ search }}" placeholder="–ü–æ—à—É–∫..." 
               class="flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
        <select name="status" class="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="">–í—Å—ñ</option>
            <option value="new" {% if status == 'new' %}selected{% endif %}>–ù–æ–≤—ñ</option>
            <option value="in_progress" {% if status == 'in_progress' %}selected{% endif %}>–í –ø—Ä–æ—Ü–µ—Å—ñ</option>
            <option value="done" {% if status == 'done' %}selected{% endif %}>–í–∏–∫–æ–Ω–∞–Ω—ñ</option>
        </select>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
            üîç
        </button>
    </form>

    <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è -->
    <div class="mb-6">
        <a href="{{ url_for('add_task') }}" 
           class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
            ‚ûï –î–æ–¥–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è
        </a>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∑–∞–≤–¥–∞–Ω—å —É —Ç–∞–±–ª–∏—Ü—ñ -->
    <div class="overflow-x-auto">
        <table class="w-full border-collapse">
            <thead>
                <tr class="bg-gray-200 text-gray-700">
                    <th class="px-4 py-2 text-left">–ù–∞–∑–≤–∞</th>
                    <th class="px-4 py-2 text-left">–û–ø–∏—Å</th>
                    <th class="px-4 py-2 text-left">–°—Ç–∞—Ç—É—Å</th>
                    <th class="px-4 py-2 text-center">–î—ñ—ó</th>
                </tr>
            </thead>
            <tbody>
                {% for task in tasks %}
                    <tr class="border-b hover:bg-gray-50">
                        <td class="px-4 py-2 font-medium">{{ task.title }}</td>
                        <td class="px-4 py-2">{{ task.description }}</td>
                        <td class="px-4 py-2">
                            {% if task.status == "new" %}
                                <span class="text-blue-600 font-semibold">–ù–æ–≤–µ</span>
                            {% elif task.status == "in_progress" %}
                                <span class="text-yellow-600 font-semibold">–í –ø—Ä–æ—Ü–µ—Å—ñ</span>
                            {% elif task.status == "done" %}
                                <span class="text-green-600 font-semibold">–í–∏–∫–æ–Ω–∞–Ω–æ</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-2 text-center flex justify-center gap-2">
                            <a href="{{ url_for('edit_task', task_id=task.id, q=search, status=status) }}" 
                               class="bg-yellow-500 text-white px-3 py-1 rounded-lg hover:bg-yellow-600">
                                ‚úèÔ∏è
                            </a>
                            <form method="post" action="{{ url_for('delete_task', task_id=task.id, q=search, status=status) }}" 
                                  onsubmit="return confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ –∑–∞–≤–¥–∞–Ω–Ω—è?');">
                                <button type="submit" class="bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600">
                                    üóëÔ∏è
                                </button>
                            </form>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="4" class="text-center text-gray-500 py-4">–ó–∞–≤–¥–∞–Ω—å –ø–æ–∫–∏ –Ω–µ–º–∞—î</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

</div>
{% endblock %}

